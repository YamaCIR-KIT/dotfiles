#!/bin/bash

distribution="dashing"

export ROS_DISTRO=$distribution
export ROS_DOMAIN_ID=87

if test -e /opt/ros/$distribution/setup.bash
then
  echo -n "[.rosrc-2] auto-source /opt/ros/$distribution/setup.bash => "

  if source /opt/ros/$distribution/setup.bash
  then
    echo "success"
  else
    echo "failure"
  fi
fi

if test -e /var/tmp/mark/c
then
  if test -e "$(cat /var/tmp/mark/c)/devel/setup.bash"
  then
    source $(cat /var/tmp/mark/c)/devel/setup.bash
  fi

  # if test -e $(cat /var/tmp/mark/c)/install/setup.bash
  # then
  #   source $(cat /var/tmp/mark/c)/install/setup.bash
  # fi

  rospack profile &> /dev/null
fi

colcon-build-autoware()
{
  colcon build --cmake-args -DCMAKE_BUILD_TYPE=Release "$@"
}

update-autoware-auto()
{
  git fetch origin
  git rebase origin/master
  git submodule update --init --recursive

  rosdep install --from-paths src --ignore-src --rosdistro "$distribution"

  colcon-build-autore
}

colcon-auto()
{
  colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release "$@"
  colcon test
  colcon test-result --verbose
}
